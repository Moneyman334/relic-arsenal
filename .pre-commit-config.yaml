# ðŸ”® ChaosKey333 Pre-commit Hooks Configuration
# Fast local feedback for code quality and formatting

repos:
  # Python Code Quality (if Python files are present)
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.6.9
    hooks:
      - id: ruff
        name: ðŸ Ruff Linter (Python)
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format
        name: ðŸ Ruff Formatter (Python)

  - repo: https://github.com/psf/black
    rev: 24.10.0
    hooks:
      - id: black
        name: ðŸ–¤ Black Formatter (Python)
        language_version: python3

  # JavaScript/TypeScript/JSON Formatting
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v4.0.0-alpha.8
    hooks:
      - id: prettier
        name: âœ¨ Prettier (JS/TS/JSON/CSS/MD)
        types_or: [javascript, typescript, jsx, tsx, json, css, scss, yaml, markdown]
        exclude: |
          (?x)(
            package-lock\.json|
            \.min\.(js|css)$|
            dist/|
            coverage/|
            node_modules/
          )

  # YAML Linting
  - repo: https://github.com/adrienverge/yamllint
    rev: v1.35.1
    hooks:
      - id: yamllint
        name: ðŸ“‹ YAML Lint
        args: [-d, relaxed]
        types: [yaml]

  # Markdown Linting
  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: v0.42.0
    hooks:
      - id: markdownlint
        name: ðŸ“ Markdown Lint
        args: [--fix]
        exclude: |
          (?x)(
            CHANGELOG\.md|
            \.github/|
            node_modules/|
            coverage/
          )

  # Git and File Quality Checks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        name: ðŸ§¹ Remove Trailing Whitespace
        exclude: |
          (?x)(
            \.min\.(js|css)$|
            \.md$
          )
      
      - id: end-of-file-fixer
        name: ðŸ“„ Fix End of Files
        exclude: |
          (?x)(
            \.min\.(js|css)$|
            \.png$|\.jpg$|\.jpeg$|\.gif$|\.svg$|\.ico$|\.pdf$
          )
      
      - id: check-yaml
        name: âœ… Check YAML Syntax
        exclude: |
          (?x)(
            \.github/workflows/.*\.yml$
          )
      
      - id: check-json
        name: âœ… Check JSON Syntax
        exclude: package-lock\.json
      
      - id: check-merge-conflict
        name: ðŸ”€ Check Merge Conflicts
      
      - id: check-case-conflict
        name: ðŸ“ Check Case Conflicts
      
      - id: check-added-large-files
        name: ðŸ“ Check Large Files
        args: [--maxkb=1000]
      
      - id: mixed-line-ending
        name: ðŸ“ Fix Line Endings
        args: [--fix=lf]

  # Security and Secrets
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        name: ðŸ”’ Detect Secrets
        args: [--baseline, .secrets.baseline]
        exclude: |
          (?x)(
            \.lock$|
            package-lock\.json|
            \.min\.(js|css)$
          )

  # Node.js specific checks (if package.json exists)
  - repo: local
    hooks:
      - id: npm-audit
        name: ðŸ›¡ï¸ NPM Security Audit
        entry: bash -c 'if [ -f package.json ]; then npm audit --audit-level=moderate; fi'
        language: system
        pass_filenames: false
        files: package\.json$

      - id: npm-lint
        name: ðŸ” NPM Lint Check
        entry: bash -c 'if [ -f package.json ] && npm run -s lint --silent > /dev/null 2>&1; then npm run lint; fi'
        language: system
        pass_filenames: false
        files: \.(js|ts|jsx|tsx)$

  # Custom ChaosKey333 Hooks
  - repo: local
    hooks:
      - id: chaos-banner
        name: âš¡ ChaosKey333 Quality Banner
        entry: bash -c 'echo "â›§âš¡ðŸ‘‘ ChaosKey333 Pre-commit Ritual Complete ðŸ‘‘âš¡â›§"; echo "ðŸ”‘ Code quality blessed by the vault guardians ðŸ”‘"'
        language: system
        pass_filenames: false
        always_run: true
        stages: [commit]

# Pre-commit configuration
default_language_version:
  python: python3
  node: '20'

# Only run on staged files
default_stages: [commit]

# Fail fast on first error
fail_fast: false

# Minimum pre-commit version
minimum_pre_commit_version: 3.0.0